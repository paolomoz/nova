name = "nova-embed"
main = "src/index.ts"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]

# --- Shared bindings ---

[[vectorize]]
binding = "VECTORIZE"
index_name = "nova-content"

[[queues.consumers]]
queue = "nova-embed-queue"
max_batch_size = 10
max_batch_timeout = 30

# --- Development (default) ---

[vars]
VOYAGE_MODEL = "voyage-3"

[dev]
port = 8789
local_protocol = "http"

# --- Production ---

[env.production]
name = "nova-embed"

[env.production.vars]
VOYAGE_MODEL = "voyage-3"

[[env.production.vectorize]]
binding = "VECTORIZE"
index_name = "nova-content"

[[env.production.queues.consumers]]
queue = "nova-embed-queue"
max_batch_size = 10
max_batch_timeout = 30
